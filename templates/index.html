<!DOCTYPE html><html lang="en"><head>    <meta charset="utf-8">    <meta http-equiv="X-UA-Compatible" content="IE=edge">    <meta name="viewport" content="width=device-width, initial-scale=1">    <meta name="description" content="">    <meta name="author" content="">    <title>Infinity - Network Monitoring System</title>    <!-- Bootstrap Core CSS -->    <link href="static/css/bootstrap.min.css" rel="stylesheet">    <!-- Custom CSS -->    <link href="static/css/agency.css" rel="stylesheet">    <!-- Custom Fonts -->    <link href="static/font-awesome-4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">    <link href="http://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">    <link href='http://fonts.googleapis.com/css?family=Kaushan+Script' rel='stylesheet' type='text/css'>    <link href='http://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic' rel='stylesheet' type='text/css'>    <link href='http://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700' rel='stylesheet' type='text/css'>    <!-- Leaflet CSS -->    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />    <link href='https://api.tiles.mapbox.com/mapbox.js/v2.1.2/mapbox.css' rel='stylesheet' />    <!-- jQuery CSS -->    <link rel="stylesheet" type="text/css" href="/static/css/jquery.datetimepicker.css"/>    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->    <!--[if lt IE 9]>        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>    <![endif]--></head><body id="page-top" class="index">    <!-- Navigation -->    <nav class="navbar navbar-default navbar-fixed-top">        <div class="container">            <!-- Brand and toggle get grouped for better mobile display -->            <div class="navbar-header page-scroll">                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">                    <span class="sr-only">Toggle navigation</span>                    <span class="icon-bar"></span>                    <span class="icon-bar"></span>                    <span class="icon-bar"></span>                </button>                <a class="navbar-brand page-title" href="#page-top">INFINITY</a>            </div>            <!-- Collect the nav links, forms, and other content for toggling -->            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">                <ul class="nav navbar-nav navbar-right">                    <li class="hidden">                        <a href="#page-top"></a>                    </li>                    <li>                        <a class="page-scroll" href="#stream_">Stream</a>                    </li>                    <li>                        <a class="page-scroll" href="#historical_">History</a>                    </li>                    <li>                        <a class="page-scroll" href="#histogram_">Histogram</a>                    </li>                    <li>                        <a class="page-scroll" href="#path_">Path</a>                    </li>                    <li>                        <a class="page-scroll" href="#settings_">Settings</a>                    </li>                    <li>                        <a class="page-scroll" href="/logout">Logout</a>                    </li>                    {% if current_user.is_authenticated() %}                        <a class="navbar-brand page-scroll"href="#page-top">                        </a>                        {% else %}                            <li><a href="/login">Login</a></li>                        {% endif %}                </ul>            </div>            <!-- /.navbar-collapse -->        </div>        <!-- /.container-fluid -->    </nav>    <!-- Header -->    <header>        <div class="container">            	<div id="map1" style="width:100%; height:480px;"></div>        </div>    </header>    <!-- Services Section -->    <section id="stream_">        <div class="container">            <div id="stream" style="width: 100%; height: 480px; margin: 0 auto"></div>        </div>    </section>    <!-- Services Section -->    <section id="historical_">        <div class="container">            <div id="chart" style="width: 100%; height: 480px; margin: 0 auto"></div>        </div>    </section>    <!-- Portfolio Grid Section -->    <section id="histogram_" >        <div class="container">            <div id="histogram" style="width: 100%; height: 480px; margin: 0 auto"></div>        </div>    </section>    <!-- About Section -->    <section id="path_">        <div class="container">                        <div id="map2" style="width: 100%; height: 460px;"></div>        </div>    </section>    <!-- Team Section -->    <section id="settings_" class="bg-light-gray">        <div class="container">            <div class="row">                <div class="col-lg-12 text-center">                    <h2 class="section-heading">Settings</h2>                    <h3 class="section-subheading text-muted">Select dates and click the Submit button</h3>                </div>            </div>            <div class="row">                <div class="col-sm-4">                    <div class="team-member">                        <h4><i>From</i> Date and Time</h4>                        <input id="datetimepicker1" type="text" >                    </div>                </div>                <div class="col-sm-4">                    <div class="team-member">                        <h4><i>To</i> Date and Time</h4>                        <input id="datetimepicker2" type="text" >                    </div>                </div>                <div class="col-sm-4">                    <div class="team-member">                         <input id="bigbutton" type="submit" value="Submit" />                    </div>                </div>            </div>        </div>    </section>    <!-- Clients Aside -->    <!-- jQuery Version 1.11.0 -->    <script src="static/js/jquery-1.11.0.js"></script>    <!-- Bootstrap Core JavaScript -->    <script src="static/js/bootstrap.min.js"></script>    <!-- Plugin JavaScript -->    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>    <script src="static/js/classie.js"></script>    <script src="static/js/cbpAnimatedHeader.js"></script>    <!-- Contact Form JavaScript -->    <script src="static/js/jqBootstrapValidation.js"></script>    <!-- Custom Theme JavaScript -->    <script src="static/js/agency.js"></script>    <script src="static/js/jquery.js"></script>    <script src="static/js/jquery.datetimepicker.js"></script>    <!-- Google JavaScript -->    <script src="http://maps.googleapis.com/maps/api/js?key=AIzaSyDY0kkJiTPVd2U7aTOAwhc9ySH6oHxOIYM&sensor=false"></script>    <script src="http://jawj.github.io/OverlappingMarkerSpiderfier/bin/oms.min.js"></script>    <!-- Leaflet JavaScript -->    <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>    <!-- HighChart JavaScript -->    <script src="http://code.highcharts.com/highcharts.js"></script><!-- Scripts follow -->    <script type="text/javascript">        var map1,map2,bigButton=false,refreshIntervalId,refreshIntervalIdSite,deviceTypes=[],markers=[],circles=[],lines=[],links=[],sites=[],links_data=[],devices_data=[],fromTime={{fromTime}},toTime={{toTime}},popup=L.popup(),test=true,onSite=false,cap_limit=2,data_cap={{data.cap}},data_data={{data.data}},data_distance={{data.distance}},stream_cap={{stream.cap}},stream_data={{stream.data}},stream_distance={{stream.distance}},hist_cap={{histogram.avg_cap}},hist_freq={{histogram.records}},hist_distance={{histogram.distance}};path_cap={{path.cap}},path_lng={{path.lng}},path_lat={{path.lat}},path_time={{path.time}},path_dist={{path.dist}},path_cov={{path.cov}},site="{{ site }}",link="{{ link }}",deviceType="{{ type }}",streamInterval="{{ streamInterval }}",updateInterval="{{ updateInterval }}";lastTime=(new Date).getTime();function loadDevicesAndLinks(){var aJ="{{ devices_url }}";var aI="{{ links_url }}";var aH=lastTime;$.post(aJ,function(aG){if(aG){clearPlacemarks();var length=aG.length;var noDevicePosition=true;for(var i=0;i<length;i++){var device=aG[i];var lat=device.lat;var lng=device.lng;aH=device.time;if(lat&&lng){noDevicePosition=false;addMarker(device,lat,lng)}}aj=$.ajax({async:true,contentType:"application/json; charset=utf-8",data:{time:aH},dataType:"json",type:"GET",url:"{{ links_url }}"});aj.done(function(aC,aB,aA){if(aC){clearLines();var length=aC.length;var noDevicePosition=true;for(var i=0;i<length;i++){var link=aC[i];var lat=link.lat;var lng=link.lng;if(lat&&lng){noDevicePosition=false;addLink(link)}}}});aj.fail(function(aF,aE,aD){})}})}function loadDevices(){clearPlacemarks();var aM="{{ devices_url }}";$.post(aM,function(aL){if(aL){var length=aL.length;var noDevicePosition=true;for(var i=0;i<length;i++){var device=aL[i];var lat=device.lat;var lng=device.lng;if(lat&&lng){noDevicePosition=false;addMarker(device,lat,lng)}}}})}function loadLinks(){var aP="{{ links_url }}";$.post(aP,function(aO){if(aO){clearLines();var length=aO.length;for(var i=0;i<length;i++){var link=aO[i];addLink(link)}}})}function addMarker(aY,aX,aW){var aV=aY.site;var aU=new Date(aY.time);aV=aV+"<br>"+aY.type;aV=aV+"<br> Tx: "+aY.tx+" Mbps ";aV=aV+"<br> Rx: "+aY.rx+" Mbps ";aV=aV+"<br> Capacity: "+aY.cap+" Mbps ";aV=aV+"<br> Traffic: "+aY.data+" Mbps ";aV=aV+"<br> Time: "+aU.toLocaleString();var aT,aS,aR;aR=aY.cap;if(aR>500){aT="#0ca35f"}else if(aR>450){aT="#3cb57e"}else if(aR>400){aT="#6dc79f"}else if(aR>350){aT="#9ddabf"}else if(aR>300){aT="#ceecdf"}else if(aR>100){aT="#d7efe5"}else{aT="red"}marker=L.circle([aX,aW],5000,{color:aT,fillColor:aT,fillOpacity:1.0});marker.addTo(map1);marker.bindPopup(aV);marker.on("click",onMarkerClick);markers.push(marker);deviceTypes.push(aY.type);sites.push(aY.site)}function addLink(ai){var ah=ai.connId;if(ai.cap>cap_limit){var d=new Date(ai.time);ah=ah+"<br> Tx: "+ai.tx+" Mbps ";ah=ah+"<br> Rx: "+ai.rx+" Mbps ";ah=ah+"<br> Distance: "+ai.distance+" miles ";ah=ah+"<br> Capacity: "+ai.cap+" Mbps ";ah=ah+"<br> Traffic: "+ai.data+" Mbps ";ah=ah+"<br> Time: "+d.toLocaleString()}else{ah=ah+" is offline"}var ag,af,ae;ae=ai.cap;if(ai.cap>cap_limit){if(ae>500){ag="#0ca35f"}else if(ae>450){ag="#3cb57e"}else if(ae>400){ag="#6dc79f"}else if(ae>350){ag="#9ddabf"}else if(ae>300){ag="#ceecdf"}else{ag="#d7efe5"}}else{if(device.distance<TYPICAL_COVERAGE_MILES){ag="red"}else{ag="orange"}}var ad=new L.LatLng(ai.lat,ai.lng);var ac=new L.LatLng(ai.lat1,ai.lng1);var ab=[ad,ac];var aa=new L.Polyline(ab,{color:ag,opacity:0.5,smoothFactor:1,weight:5});aa.addTo(map1);lines.push(aa);aa.bindPopup(ah);aa.on("click",onLinkClick);links.push(ai.connId)}function clearPlacemarks(){for(var i=0;i<markers.length;i++){map1.removeLayer(markers[i])}markers=[];sites=[];deviceTypes=[]}function clearLines(){for(var i=0;i<lines.length;i++){map1.removeLayer(lines[i])}lines=[];links=[]}function addCircle(au,at,as,ar,aq,ap){var ao,an,am;if(ap){if(as>500){ao="#0ca35f"}else if(as>450){ao="#3cb57e"}else if(as>400){ao="#6dc79f"}else if(as>350){ao="#9ddabf"}else if(as>300){ao="#ceecdf"}else{ao="#d7efe5"}}else{if(aq<TYPICAL_COVERAGE_MILES){ao="red"}else{ao="orange"}}an=L.circle([at,au],250,{color:ao,fillColor:ao,fillOpacity:0.5});an.addTo(map2);am=new Date(ar);title=site;title=title+"<br> Lat: "+at;title=title+"<br> Lng: "+au;title=title+"<br> Distance: "+aq+" miles ";title=title+"<br> Capacity: "+as+" Mbps ";title=title+"<br> Time: "+am.toLocaleString();an.bindPopup(title);circles.push(an)}function addCircle_site(aCA,aBA,aAA,az){var ay,ax,aw;if(aAA>40){ay="#0ca35f"}else if(aAA>30){ay="#3cb57e"}else if(aAA>20){ay="#6dc79f"}else if(aAA>10){ay="#9ddabf"}else if(aAA>5){ay="#ceecdf"}else if(aAA>1){ay="#d7efe5"}else{ay="red"}ax=L.circle([aBA,aCA],250,{color:ay,fillColor:ay,fillOpacity:0.5});ax.addTo(map2);aw=new Date(az);title=site;title=title+"<br> Lat: "+aBA;title=title+"<br> Lng: "+aCA;title=title+"<br> Capacity: "+aAA+" Mbps ";title=title+"<br> Time: "+aw.toLocaleString();ax.bindPopup(title);circles.push(ax)}function clearCircles(){var aEA=circles.length;for(var i=0;i<aEA;i++){var circle=circles[i];map2.removeLayer(circle)}circles=[]}function addConnectionLine(aOA,aNA,aMA,aLA,aKA){var aJA=new L.LatLng(aOA,aNA);var aIA=new L.LatLng(aMA,aLA);var aHA=[aJA,aIA];var aGA=new L.Polyline(aHA,{color:aKA,opacity:0.5,smoothFactor:1,weight:3});aGA.addTo(map);lines.push(aGA)}function firstMap(){map1=L.map("map1").setView([33.732124,-117.900595],8);L.tileLayer("http://{s}.tiles.mapbox.com/v3/infinity.k4e0f93f/{z}/{x}/{y}.png",{maxZoom:18}).addTo(map1);map1.attributionControl.setPrefix(false);map1.dragging.disable();map1.touchZoom.disable();map1.doubleClickZoom.disable();map1.scrollWheelZoom.disable();if(map1.tap)map1.tap.disable();loadDevicesAndLinks()}function secondMap(){map2=L.map("map2").setView(medLatLng(path_lat,path_lng),9);L.tileLayer("http://{s}.tiles.mapbox.com/v3/saswata.jldkb3nl/{z}/{x}/{y}.png",{maxZoom:18}).addTo(map2);map2.attributionControl.setPrefix(false);map2.touchZoom.disable();map2.dragging.disable();if(map2.tap)map2.tap.disable();map2.doubleClickZoom.disable();map2.scrollWheelZoom.disable();clearCircles();for(i=0;i<path_cap.length;i+=1){addCircle(path_lng[i],path_lat[i],path_cap[i],path_time[i],path_dist[i],path_cov[i])}}function medLatLng(aZA,aYA){var aXA=Math.min.apply(null,aZA),aWA=Math.max.apply(null,aZA),aVA=(aWA+aXA)/2,aUA=Math.min.apply(null,aYA),aTA=Math.max.apply(null,aYA),aSA=(aTA+aUA)/2;return[aVA,aSA]}function onMapClick1(abA){popup.setLatLng(abA.latlng).setContent("You clicked the map at "+abA.latlng.toString()).openOn(map1);map1.panTo(abA.latlng)}function onMapClick2(adA){popup.setLatLng(adA.latlng).setContent("You clicked the map at "+adA.latlng.toString()).openOn(map2);map2.panTo(adA.latlng)}function onMarkerClick(afA){map1.panTo(afA.latlng);for(i=0;i<markers.length;i++){if(markers[i]._leaflet_id==this._leaflet_id){site=sites[i];deviceType=deviceTypes[i]}}onSite=true;window.clearInterval(refreshIntervalIdSite);getDataMarker();lastPointDataMarker()}function onLinkClick(ahA){map1.panTo(ahA.latlng);for(i=0;i<lines.length;i++){if(lines[i]._leaflet_id==this._leaflet_id){site=links[i];deviceType=deviceTypes[i*2]}}onSite=false;window.clearInterval(refreshIntervalId);getData();lastPointData()}function lastPointDataMarker(){refreshIntervalIdSite=window.setInterval(function(){var aqA=$("#stream").highcharts();aj=$.ajax({async:true,contentType:"application/json; charset=utf-8",data:{lastTime:lastTime,site:site,type:deviceType},dataType:"json",type:"GET",url:"{{ lastpoint_url_site }}"});aj.done(function(amA,alA,akA){var ajA=amA.cap.length;if(ajA>0){lastTime=amA.cap[ajA-1][0]}for(i=0;i<ajA;i++){if((aqA.series[0].points.length)<80){aqA.series[0].addPoint(amA.data[0],false);aqA.series[1].addPoint(amA.cap[0],false);aqA.series[2].addPoint(amA.distance[0],true)}else{aqA.series[0].addPoint(amA.data[0],false,true);aqA.series[1].addPoint(amA.cap[0],false,true);aqA.series[2].addPoint(amA.distance[0],true,true)}}});aj.fail(function(apA,aoA,anA){})},streamInterval)}function getDataMarker(){aj=$.ajax({async:true,contentType:"application/json; charset=utf-8",data:{site:site,type:deviceType},dataType:"json",type:"GET",url:"{{ stream_url_site }}"});aj.done(function(avA,auA,atA){var asA=$("#stream").highcharts();asA.series[0].setData(avA.data,false);asA.series[1].setData(avA.cap,false);asA.series[2].setData(avA.distance,true);asA.setTitle(null,{text:site})});aj.fail(function(ayA,axA,awA){});aj=$.ajax({async:true,contentType:"application/json; charset=utf-8",data:{fromTime:fromTime,site:site,toTime:toTime,type:deviceType},dataType:"json",type:"GET",url:"{{ chart_url_site }}"});aj.done(function(aCB,aBB,aAB){var azA=$("#chart").highcharts();azA.series[0].setData(aCB.data,false);azA.series[1].setData(aCB.cap,false);azA.series[2].setData(aCB.distance,true);azA.setTitle(null,{text:site})});aj.fail(function(aFB,aEB,aDB){});aj1=$.ajax({async:true,contentType:"application/json; charset=utf-8",data:{fromTime:fromTime,site:site,toTime:toTime,type:deviceType},dataType:"json",type:"GET",url:"{{ histogram_url_site }}"});aj1.done(function(aJB,aIB,aHB){var aGB=$("#histogram").highcharts();aGB.xAxis[0].setCategories(aJB.distance,false);aGB.series[0].setData(aJB.avg_cap,false);aGB.series[1].setData(aJB.records,true);aGB.setTitle(null,{text:site})});aj1.fail(function(aMB,aLB,aKB){});aj2=$.ajax({async:true,contentType:"application/json; charset=utf-8",data:{fromTime:fromTime,site:site,toTime:toTime,type:deviceType},dataType:"json",type:"GET",url:"{{ path_url_site }}"});aj2.done(function(aPB,aOB,aNB){if(aPB.lat.length>0){map2.panTo(medLatLng(aPB.lat,aPB.lng));clearCircles();for(i=0;i<aPB.cap.length;i++){addCircle_site(aPB.lng[i],aPB.lat[i],aPB.cap[i],aPB.time[i])}}else clearCircles();});aj2.fail(function(aSB,aRB,aQB){})}function lastPointData(){refreshIntervalId=window.setInterval(function(){var abB=$("#stream").highcharts();aj=$.ajax({async:true,contentType:"application/json; charset=utf-8",data:{lastTime:lastTime,site:site,type:deviceType},dataType:"json",type:"GET",url:"{{ lastpoint_url }}"});aj.done(function(aXB,aWB,aVB){var aUB=aXB.cap.length;if(aUB>0){lastTime=aXB.cap[aUB-1][0]}for(i=0;i<aUB;i++){if((abB.series[0].points.length)<80){abB.series[0].addPoint(aXB.data[0],false);abB.series[1].addPoint(aXB.cap[0],false);abB.series[2].addPoint(aXB.distance[0],true)}else{abB.series[0].addPoint(aXB.data[0],false,true);abB.series[1].addPoint(aXB.cap[0],false,true);abB.series[2].addPoint(aXB.distance[0],true,true)}}});aj.fail(function(aaB,aZB,aYB){})},streamInterval)}function getData(){aj=$.ajax({async:true,contentType:"application/json; charset=utf-8",data:{site:site,type:deviceType},dataType:"json",type:"GET",url:"{{ stream_url }}"});aj.done(function(agB,afB,aeB){var adB=$("#stream").highcharts();adB.series[0].setData(agB.data,false);adB.series[1].setData(agB.cap,false);adB.series[2].setData(agB.distance,true);adB.setTitle(null,{text:site})});aj.fail(function(ajB,aiB,ahB){});aj=$.ajax({async:true,contentType:"application/json; charset=utf-8",data:{fromTime:fromTime,site:site,toTime:toTime,type:deviceType},dataType:"json",type:"GET",url:"{{ chart_url }}"});aj.done(function(anB,amB,alB){var akB=$("#chart").highcharts();akB.series[0].setData(anB.data,false);akB.series[1].setData(anB.cap,false);akB.series[2].setData(anB.distance,true);akB.setTitle(null,{text:site})});aj.fail(function(aqB,apB,aoB){});aj1=$.ajax({async:true,contentType:"application/json; charset=utf-8",data:{fromTime:fromTime,site:site,toTime:toTime,type:deviceType},dataType:"json",type:"GET",url:"{{ histogram_url }}"});aj1.done(function(auB,atB,asB){var arB=$("#histogram").highcharts();arB.xAxis[0].setCategories(auB.distance,false);arB.series[0].setData(auB.avg_cap,false);arB.series[1].setData(auB.records,true);arB.setTitle(null,{text:site})});aj1.fail(function(axB,awB,avB){});aj2=$.ajax({async:true,contentType:"application/json; charset=utf-8",data:{fromTime:fromTime,site:site,toTime:toTime,type:deviceType},dataType:"json",type:"GET",url:"{{ path_url }}"});aj2.done(function(aAC,azB,ayB){if(aAC.lat.length>0){map2.panTo(medLatLng(aAC.lat,aAC.lng));clearCircles();for(i=0;i<aAC.cap.length;i++){addCircle(aAC.lng[i],aAC.lat[i],aAC.cap[i],aAC.time[i],aAC.dist[i],aAC.cov[i])}}else clearCircles();});aj2.fail(function(aDC,aCC,aBC){})}$(window).on("blur focus",function(aGC){var aFC=$(this).data("prevType");if(aFC!=aGC.type){switch(aGC.type){case "blur":break;case "focus":window.location.reload();break}}$(this).data("prevType",aGC.type)});function getDataNoStream(){aj=$.ajax({async:true,contentType:"application/json; charset=utf-8",data:{fromTime:fromTime,site:site,toTime:toTime,type:deviceType},dataType:"json",type:"GET",url:"{{ chart_url }}"});aj.done(function(aKC,aJC,aIC){var aHC=$("#chart").highcharts();aHC.series[0].setData(aKC.data,false);aHC.series[1].setData(aKC.cap,false);aHC.series[2].setData(aKC.distance,true);aHC.setTitle(null,{text:site})});aj.fail(function(aNC,aMC,aLC){});aj1=$.ajax({async:true,contentType:"application/json; charset=utf-8",data:{fromTime:fromTime,site:site,toTime:toTime,type:deviceType},dataType:"json",type:"GET",url:"{{ histogram_url }}"});aj1.done(function(aRC,aQC,aPC){var aOC=$("#histogram").highcharts();aOC.xAxis[0].setCategories(aRC.distance,false);aOC.series[0].setData(aRC.avg_cap,false);aOC.series[1].setData(aRC.records,true);aOC.setTitle(null,{text:site})});aj1.fail(function(aUC,aTC,aSC){});aj2=$.ajax({async:true,contentType:"application/json; charset=utf-8",data:{fromTime:fromTime,site:site,toTime:toTime,type:deviceType},dataType:"json",type:"GET",url:"{{ path_url }}"});aj2.done(function(aXC,aWC,aVC){if(aXC.lat.length>0){map2.panTo(medLatLng(aXC.lat,aXC.lng));clearCircles();for(i=0;i<aXC.cap.length;i++){addCircle(aXC.lng[i],aXC.lat[i],aXC.cap[i],aXC.time[i],aXC.dist[i],aXC.cov[i])}}else clearCircles();});aj2.fail(function(aaC,aZC,aYC){})}function getDataMarkerNoStream(){aj=$.ajax({async:true,contentType:"application/json; charset=utf-8",data:{fromTime:fromTime,site:site,toTime:toTime,type:deviceType},dataType:"json",type:"GET",url:"{{ chart_url_site }}"});aj.done(function(afC,aeC,adC){var acC=$("#chart").highcharts();acC.series[0].setData(afC.data,false);acC.series[1].setData(afC.cap,false);acC.series[2].setData(afC.distance,true);acC.setTitle(null,{text:site})});aj.fail(function(aiC,ahC,agC){});aj1=$.ajax({async:true,contentType:"application/json; charset=utf-8",data:{fromTime:fromTime,site:site,toTime:toTime,type:deviceType},dataType:"json",type:"GET",url:"{{ histogram_url_site }}"});aj1.done(function(amC,alC,akC){var ajC=$("#histogram").highcharts();ajC.xAxis[0].setCategories(amC.distance,false);ajC.series[0].setData(amC.avg_cap,false);ajC.series[1].setData(amC.records,true);ajC.setTitle(null,{text:site})});aj1.fail(function(apC,aoC,anC){});aj2=$.ajax({async:true,contentType:"application/json; charset=utf-8",data:{fromTime:fromTime,site:site,toTime:toTime,type:deviceType},dataType:"json",type:"GET",url:"{{ path_url_site }}"});aj2.done(function(asC,arC,aqC){if(asC.lat.length>0){map2.panTo(medLatLng(asC.lat,asC.lng));clearCircles();for(i=0;i<asC.cap.length;i++){addCircle_site(asC.lng[i],asC.lat[i],asC.cap[i],asC.time[i])}}else clearCircles();});aj2.fail(function(avC,auC,atC){})}$("#datetimepicker1").datetimepicker({format:"unixtime",inline:true,onChangeDateTime:function(ayC,axC){tempTime=Number(axC.val()*1000);if(tempTime!=toTime){fromTime=tempTime}},scrollMonth:false,scrollTime:false});$("#datetimepicker2").datetimepicker({format:"unixtime",inline:true,onChangeDateTime:function(aAD,azC){tempTime=Number(azC.val()*1000);if(tempTime!=fromTime){toTime=tempTime}},scrollMonth:false,scrollTime:false});$("#bigbutton").click(function(){if(onSite){window.clearInterval(refreshIntervalIdSite);getDataMarkerNoStream();lastPointDataMarker()}else{window.clearInterval(refreshIntervalId);getDataNoStream();lastPointData()}});$(function(){firstMap();secondMap();Highcharts.setOptions({global:{useUTC:false}});var aJD={chart:{events:{load:function(){if(onSite){lastPointDataMarker()}else{lastPointData()}}}},credits:false,exporting:false,legend:{align:"left",backgroundColor:(Highcharts.theme&&Highcharts.theme.legendBackgroundColor)||"#FFFFFF",floating:true,layout:"vertical",verticalAlign:"top",x:120,y:80},series:[{dashStyle:"shortdot",data:stream_data,name:"Traffic",tooltip:{valueSuffix:" Mbps"},type:"spline",yAxis:1},{data:stream_cap,name:"Capacity",tooltip:{valueSuffix:" Mbps"},type:"spline",yAxis:1},{data:stream_distance,marker:{enabled:false},name:"Distance",tooltip:{valueSuffix:" miles"},type:"spline",yAxis:0}],subtitle:{text:site},title:{text:"Streaming Traffic, Capacity, Distance"},tooltip:{formatter:function(){var aCD="<b>"+Highcharts.dateFormat("%A, %b %e, %Y, %H:%M:%S",this.x)+"</b>";index=0;$.each(this.points,function(aBD){if(aBD==0){aCD+="<br/><span style='color:#6EA3ED; font-weight:bold;'> Traffic: "+this.y+"  Mbps"}if(aBD==1){aCD+="<br/><span style='color:#333338; font-weight:bold;'> Capacity: "+this.y+"  Mbps"}if(aBD==2){aCD+="<br/><span style='color:#88EF57; font-weight:bold;'> Distance: "+this.y+"  miles"}if(aBD<2){aBD=+1}else{aBD=0}});return aCD},shared:true,valueDecimals:2},xAxis:{minRange:1000,tickInterval:10000,type:"datetime"},yAxis:[{floor:0,gridLineWidth:0,labels:{format:"{value} miles",style:{color:Highcharts.getOptions().colors[2]}},opposite:false,title:{style:{color:Highcharts.getOptions().colors[2]},text:"Distance"}},{floor:0,labels:{format:"{value}Mbps",style:{color:Highcharts.getOptions().colors[0]}},opposite:true,title:{style:{color:Highcharts.getOptions().colors[0]},text:"Traffic, Capacity"}}]};var aID={credits:false,exporting:false,legend:{align:"left",backgroundColor:(Highcharts.theme&&Highcharts.theme.legendBackgroundColor)||"#FFFFFF",floating:true,layout:"vertical",verticalAlign:"top",x:120,y:80},series:[{dashStyle:"shortdot",data:data_data,name:"Traffic",tooltip:{valueSuffix:" Mbps"},type:"spline",yAxis:1},{data:data_cap,name:"Capacity",tooltip:{valueSuffix:" Mbps"},type:"spline",yAxis:1},{data:data_distance,marker:{enabled:false},name:"Distance",tooltip:{valueSuffix:" miles"},type:"spline",yAxis:0}],subtitle:{text:site},title:{text:"Traffic, Capacity, Distance"},tooltip:{formatter:function(){var aED="<b>"+Highcharts.dateFormat("%A, %b %e, %Y, %H:%M:%S",this.x)+"</b>";index=0;$.each(this.points,function(aDD){if(aDD==0){aED+="<br/><span style='color:#6EA3ED; font-weight:bold;'> Traffic: "+this.y+"  Mbps"}if(aDD==1){aED+="<br/><span style='color:#333338; font-weight:bold;'> Capacity: "+this.y+"  Mbps"}if(aDD==2){aED+="<br/><span style='color:#88EF57; font-weight:bold;'> Distance: "+this.y+"  miles"}if(aDD<2){aDD=+1}else{aDD=0}});return aED},shared:true,valueDecimals:2},xAxis:{minRange:60000,tickInterval:120000,type:"datetime"},yAxis:[{floor:0,gridLineWidth:0,labels:{format:"{value} miles",style:{color:Highcharts.getOptions().colors[2]}},opposite:false,title:{style:{color:Highcharts.getOptions().colors[2]},text:"Distance"}},{floor:0,labels:{format:"{value}Mbps",style:{color:Highcharts.getOptions().colors[0]}},opposite:true,title:{style:{color:Highcharts.getOptions().colors[0]},text:"Traffic, Capacity"}}]};var aHD={credits:false,exporting:false,legend:{align:"left",backgroundColor:(Highcharts.theme&&Highcharts.theme.legendBackgroundColor)||"#FFFFFF",floating:true,layout:"vertical",verticalAlign:"top",x:120,y:80},navigator:{enabled:false},rangeSelector:{enabled:false},series:[{data:hist_cap,name:"Capacity",type:"column",yAxis:0},{data:hist_freq,marker:{enabled:false},name:"Frequency",type:"column",yAxis:1}],subtitle:{text:site},title:{text:"Capacity vs Distance"},tooltip:{formatter:function(){var aGD="<span style='color:#88EF57; font-weight:bold;'> Distance: "+this.x+"  miles";index=0;$.each(this.points,function(aFD){if(aFD==0){aGD+="<br/><span style='color:#6EA3ED; font-weight:bold;'> Traffic: "+this.y+"  Mbps"}if(aFD==1){aGD+="<br/><span style='color:#333338; font-weight:bold;'> Capacity: "+this.y+"  Mbps"}if(aFD<1){aFD=+1}else{aFD=0}});return aGD},shared:true,valueDecimals:2},xAxis:[{categories:hist_distance},{title:{style:{color:Highcharts.getOptions().colors[3]},text:"Distance"}}],yAxis:[{labels:{format:"{value} Mbps",style:{color:Highcharts.getOptions().colors[0]}},opposite:true,title:{style:{color:Highcharts.getOptions().colors[0]},text:"Capacity"}},{gridLineWidth:0,labels:{format:"{value} %",style:{color:Highcharts.getOptions().colors[1]}},title:{style:{color:Highcharts.getOptions().colors[1]},text:"Frequency"}}]};$("#stream").highcharts(aJD);$("#chart").highcharts(aID);$("#histogram").highcharts(aHD);window.setInterval(function(){loadDevicesAndLinks()},updateInterval)});    </script></body></html>